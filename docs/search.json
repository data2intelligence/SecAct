[{"path":"/articles/bulk.html","id":"case-1","dir":"Articles","previous_headings":"","what":"Case 1","title":"Infer the secreted protein activity from gene expression in bulk level","text":"current case includes differential expression profiles anti-IFNG treatment control samples.","code":"library(SecAct)  # prepare expression matrix exprPath <- file.path(system.file(package=\"SecAct\"), \"extdata/IFNG_GSE100093.diff.gz\") expr <- read.csv(exprPath, row.names=1, check.names=F)  # run SecAct to infer activity res <- SecAct.inference(expr, lambda=10000, nrand=1000)  # show activity head(res$zscore)"},{"path":"/articles/bulk.html","id":"case-2","dir":"Articles","previous_headings":"","what":"Case 2","title":"Infer the secreted protein activity from gene expression in bulk level","text":"case aims infer secreted protein activity pancreatic cancer RNA-Seq cohorts CPTAC. Note: control samples, recommend normalize expression values gene zero mean across samples. words, just use expression matrix control.","code":"library(SecAct)  # read expression matrix exprPath <- file.path(system.file(package=\"SecAct\"), \"extdata/CPTAC_PDAC_Tumor.csv.gz\") expr <- read.csv(exprPath, row.names=1, check.names=F)  exprControlPath <- file.path(system.file(package=\"SecAct\"), \"extdata/CPTAC_PDAC_Normal.csv.gz\") exprControl <- read.csv(exprControlPath, row.names=1, check.names=F)  # normalize expression matrix expr <- expr - rowMeans(exprControl)  # run SecAct to infer activity res <- SecAct.inference(expr, lambda=10000, nrand=1000)  # show activity head(res$zscore) # normalize the expression values of each gene to zero mean across samples expr <- expr - rowMeans(expr)"},{"path":"/articles/singleCell.html","id":"prepare-expression-matrix","dir":"Articles","previous_headings":"","what":"Prepare expression matrix","title":"Infer the secreted protein activity from single-cell RNA-Seq data","text":", use scRNA-Seq data includes T cell Normal Tumor tissue.","code":"library(SecAct)  # load seurat object seuratPath <- file.path(system.file(package=\"SecAct\"), \"extdata/OV_GSE156728.rds\") seurat_obj <- readRDS(seuratPath)  # extract count matrix expr <-  as.matrix(seurat_obj@assays$RNA@layers$counts) colnames(expr) <- rownames(seurat_obj@assays$RNA@cells) rownames(expr) <- rownames(seurat_obj@assays$RNA@features)  # normalize to TPM expr <- t(t(expr)*1e6/colSums(expr))  # transform to log space expr <- log2(expr/10 + 1)  # normalized with the control samples expr <- expr - rowMeans(expr) expr <- round(expr,3)  # run SecAct to infer activity res_sc <- SecAct.inference(expr, lambda=10000, nrand=1000)  # show activity head(res$zscore)"},{"path":"/articles/singleCell.html","id":"add-secact-output-to-seurat-object","dir":"Articles","previous_headings":"","what":"Add SecAct output to Seurat object","title":"Infer the secreted protein activity from single-cell RNA-Seq data","text":"can integrate activity results Seurat object, visiualize .","code":"res_sc_z <- t(res_sc$zscore) colnames(res_sc_z) <- paste0(\"activity_\",colnames(res_sc_z))  seurat_obj@meta.data <- cbind(seurat_obj@meta.data,res_sc_z)  library(Seurat) library(ggplot2) library(patchwork)  p1 <- FeaturePlot(seurat_obj, reduction = \"umap\", features = c(\"activity_IFNG\")) +   scale_colour_gradient2(low = \"blue\", mid = \"white\", high = \"red\") p2 <- DimPlot(seurat_obj, reduction = \"umap\", group.by = \"cellType\") p3 <- VlnPlot(seurat_obj, features = c(\"activity_IFNG\"), )  p1|p2|p3"},{"path":"/articles/spatial.html","id":"read-st-data-to-an-spacet-object","dir":"Articles","previous_headings":"","what":"Read ST data to an SpaCET object","title":"Infer secreted protein activity in spatial transcriptomics data","text":"dataset includes two endometrial cancer patients treated anti-Netrin-1 (NTN1) compound. Netrin-1 secreted glycoprotein plays critical roles angiogenesis cell survival, blocking NTN1 inhibits tumor growth. patient pre- -treatment tumor samples, respectively. read ST data R, user can create SpaCET object using create.SpaCET.object.10X.","code":"library(SpaCET)  # set the path to the data folder. dataPath <- file.path(system.file(package=\"SecAct\"), \"extdata/\")  # load ST data to create an SpaCET object. # read on-treatment sample visiumPath <- paste0(dataPath,\"UCEC_On/\") SpaCET_obj_on <- create.SpaCET.object.10X(visiumPath = visiumPath) SpaCET_obj_on <- SpaCET.quality.control(SpaCET_obj_on)  # read pre-treatment sample visiumPath <- paste0(dataPath,\"UCEC_Pre/\") SpaCET_obj_pre <- create.SpaCET.object.10X(visiumPath = visiumPath) SpaCET_obj_pre <- SpaCET.quality.control(SpaCET_obj_pre)"},{"path":"/articles/spatial.html","id":"infer-secreted-protein-activity","dir":"Articles","previous_headings":"","what":"Infer secreted protein activity","title":"Infer secreted protein activity in spatial transcriptomics data","text":"loading ST data, user can run SecAct.inference infer activities 1000 secreted proteins across spot. note, analyze -treatment sample, pre-treatment sample set control. , normalize expression values gene -treatment sample -spot mean pre-treatment sample. analyzing pre-treatment sample, control sample unavailable. Just normalize expression values gene pre-treatment sample zero mean across spots. words, just regard ST sample control sample.","code":"# extract count matrix expr_on <- as.matrix(SpaCET_obj_on@input$counts) expr_pre <- as.matrix(SpaCET_obj_pre@input$counts)  # normalize to TPM expr_on <- t(t(expr_on)*1e6/colSums(expr_on)) expr_pre <- t(t(expr_pre)*1e6/colSums(expr_pre))  # transform to log space expr_on <- log2(expr_on/10 + 1) expr_pre <- log2(expr_pre/10 + 1)  # normalized with the control samples expr_on_rmControl <- expr_on - rowMeans(expr_pre) expr_on_rmControl <- round(expr_on_rmControl,3)  expr_pre_rmControl <- expr_pre - rowMeans(expr_pre) expr_pre_rmControl <- round(expr_pre_rmControl,3)  # run SecAct to infer activity library(SecAct) res_on <- SecAct.inference(expr_on_rmControl, lambda=10000, nrand=1000) res_pre <- SecAct.inference(expr_pre_rmControl, lambda=10000, nrand=1000)"},{"path":"/articles/spatial.html","id":"add-secact-output-to-spacet-object","dir":"Articles","previous_headings":"","what":"Add SecAct output to SpaCET object","title":"Infer secreted protein activity in spatial transcriptomics data","text":"can integrate activity results SpaCET object, visiualize .","code":"SpaCET_obj_on@results$activity <- res_on SpaCET_obj_pre@results$activity <- res_pre  library(patchwork) p1 <- SecAct.spatial.velocity(SpaCET_obj_pre, gene = \"TGFB1\", signalMode=\"receiving\")  p2 <- SecAct.spatial.velocity(SpaCET_obj_on, gene = \"TGFB1\", signalMode=\"receiving\")   p1|p2"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Beibei Ru. Author, maintainer. Peng Jiang. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ru B, Jiang P (2024). SecAct: Secreted Signaling Activity Inference. R package version 1.0.0, https://github.com/data2intelligence/SecAct.","code":"@Manual{,   title = {SecAct: Secreted Signaling Activity Inference},   author = {Beibei Ru and Peng Jiang},   year = {2024},   note = {R package version 1.0.0},   url = {https://github.com/data2intelligence/SecAct}, }"},{"path":"/index.html","id":"secact-secreted-protein-activity-inference-","dir":"","previous_headings":"","what":"Secreted Signaling Activity Inference","title":"Secreted Signaling Activity Inference","text":"SecAct R package desighed inferring intercellular activity secreted proteins tumors gene expression profiles. Users can input multiple modalities expression data, including bulk, single-cell, spatial transcriptomics. outputs 1248 secreted protein activities sample, individual cell, ST spot, respectively. SecAct achieves leveraging intercellular signatures trained 618 genome-wide spatial transcriptomics profiles across 28 tumor types. input spatial transcriptomics, SecAct additionally calculates signaling velocities secreted proteins source sink spots.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Secreted Signaling Activity Inference","text":"install SecAct, recommend using devtools: user can install SecAct source code. Click download .","code":"# install.packages(\"devtools\") devtools::install_github(\"data2intelligence/SecAct\") # install SecAct in the R environment. install.packages(\"Path_to_the_source_code\", repos = NULL, type=\"source\")"},{"path":"/index.html","id":"dependencies","dir":"","previous_headings":"","what":"Dependencies","title":"Secreted Signaling Activity Inference","text":"R version >= 4.2.0. R packages: Matrix, ggplot2, patchwork. C Library: GSL.","code":""},{"path":"/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Secreted Signaling Activity Inference","text":"","code":"library(SecAct)  # prepare expression matrix exprPath <- file.path(system.file(package=\"SecAct\"), \"extdata/IFNG_GSE100093.diff\") expr <- read.table(exprPath, sep=\"\\t\", check.names=F)  # run SecAct to infer activity res <- SecAct.inference(expr, lambda=10000, nrand=1000)  # show activity head(res$zscore)"},{"path":"/index.html","id":"tutorial","dir":"","previous_headings":"","what":"Tutorial","title":"Secreted Signaling Activity Inference","text":"Infer secreted protein activity gene expression bulk level Infer secreted protein activity single-cell RNA-Seq data Infer secreted protein activity spatial transcriptomics data","code":""},{"path":"/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Secreted Signaling Activity Inference","text":"Beibei Ru, Lanqi Gong, Emily Yang, Kenneth Aldape, Lalage Wakefield, Peng Jiang. Inferring secreted protein activities bulk, single-cell, spatial levels. [Link]","code":""},{"path":"/reference/SecAct-package.html","id":null,"dir":"Reference","previous_headings":"","what":"SecAct: Secreted Signaling Activity Inference — SecAct-package","title":"SecAct: Secreted Signaling Activity Inference — SecAct-package","text":"Inferring secreted protein activities bulk, single-cell, spatial levels","code":""},{"path":[]},{"path":"/reference/SecAct-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"SecAct: Secreted Signaling Activity Inference — SecAct-package","text":"Maintainer: Beibei Ru beibei.ru@nih.gov Authors: Peng Jiang peng.jiang@nih.gov","code":""},{"path":"/reference/SecAct.inference.html","id":null,"dir":"Reference","previous_headings":"","what":"Secreted protein activity inference — SecAct.inference","title":"Secreted protein activity inference — SecAct.inference","text":"Infer activity 1000 secreted proteins tumor gene expression profiles.","code":""},{"path":"/reference/SecAct.inference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Secreted protein activity inference — SecAct.inference","text":"","code":"SecAct.inference(expr, SigMat = \"SecAct\", lambda = 10000, nrand = 1000)"},{"path":"/reference/SecAct.inference.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Secreted protein activity inference — SecAct.inference","text":"expr Gene expression matrix gene symbol (row) x sample (column). lambda Penalty factor ridge regression. nrand Number randomizations permutation test, default value 1000. sigMatrix Secreted protein signature matrix.","code":""},{"path":"/reference/SecAct.inference.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Secreted protein activity inference — SecAct.inference","text":"list four items, matrix. beta: regression coefficients se: standard errors coefficients zscore: beta/se pvalue: statistical significance","code":""},{"path":"/reference/SecAct.inference.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Secreted protein activity inference — SecAct.inference","text":"","code":"exprPath <- file.path(system.file(package = \"SecAct\"), \"extdata/IFNG_GSE100093.diff\") expr <- read.table(expr, sep=\"\\t\", check.names=F) res <- SecAct.inference(expr, lambda=10000, nrand=1000) head(res$zscore)"},{"path":"/reference/SecAct.signalling.direction.html","id":null,"dir":"Reference","previous_headings":"","what":"FUNCTION_TITLE — SecAct.signalling.direction","title":"FUNCTION_TITLE — SecAct.signalling.direction","text":"FUNCTION_DESCRIPTION","code":""},{"path":"/reference/SecAct.signalling.direction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"FUNCTION_TITLE — SecAct.signalling.direction","text":"","code":"SecAct.signalling.direction(   SpaCET_obj,   gene,   signalMode = \"both\",   signalDir = TRUE )"},{"path":"/reference/SecAct.signalling.direction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"FUNCTION_TITLE — SecAct.signalling.direction","text":"SpaCET_obj PARAM_DESCRIPTION gene PARAM_DESCRIPTION signalMode PARAM_DESCRIPTION signalDir PARAM_DESCRIPTION","code":""},{"path":"/reference/SecAct.signalling.direction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"FUNCTION_TITLE — SecAct.signalling.direction","text":"OUTPUT_DESCRIPTION","code":""},{"path":"/reference/SecAct.signalling.direction.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"FUNCTION_TITLE — SecAct.signalling.direction","text":"DETAILS","code":""},{"path":"/reference/SecAct.spatial.velocity.html","id":null,"dir":"Reference","previous_headings":"","what":"Secreted protein signaling velocity — SecAct.spatial.velocity","title":"Secreted protein signaling velocity — SecAct.spatial.velocity","text":"Calculate signaling velocity secreted proteins based activities.","code":""},{"path":"/reference/SecAct.spatial.velocity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Secreted protein signaling velocity — SecAct.spatial.velocity","text":"","code":"SecAct.spatial.velocity(SpaCET_obj, gene, signalMode = \"both\")"},{"path":"/reference/SecAct.spatial.velocity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Secreted protein signaling velocity — SecAct.spatial.velocity","text":"SpaCET_obj SpaCET object. gene Gene symbol coding secreted protein. signalMode Mode signaling velocity, .e., \"receiving\", \"sending\", \"\".","code":""},{"path":"/reference/SecAct.spatial.velocity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Secreted protein signaling velocity — SecAct.spatial.velocity","text":"ggplot2 object.","code":""},{"path":"/reference/SecAct.spatial.velocity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Secreted protein signaling velocity — SecAct.spatial.velocity","text":"velocity direction starts source cell producing secreted protein moves sink cells receiving secreted protein signal. velocity magnitude represents product secreted protein-coding gene expression source cells signaling activities sink cells.","code":""},{"path":"/reference/SecAct.spatial.velocity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Secreted protein signaling velocity — SecAct.spatial.velocity","text":"","code":"SecAct.spatial.velocity(SpaCET_obj, gene=\"TGFB1\", signalMode=\"receiving\") SecAct.spatial.velocity(SpaCET_obj, gene=\"TGFB1\", signalMode=\"sending\") SecAct.spatial.velocity(SpaCET_obj, gene=\"TGFB1\", signalMode=\"both\")"},{"path":"/news/index.html","id":"secact-100","dir":"Changelog","previous_headings":"","what":"SecAct 1.0.0","title":"SecAct 1.0.0","text":"2024-07-28 Release SecAct package.","code":""}]
