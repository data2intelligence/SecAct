<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Secreted protein signaling activity for distinct cell states from scRNA-Seq data • SecAct</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Secreted protein signaling activity for distinct cell states from scRNA-Seq data">
<meta name="description" content="Secreted protein signaling activity for distinct cell states from scRNA-Seq data.
">
<meta property="og:description" content="Secreted protein signaling activity for distinct cell states from scRNA-Seq data.
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SecAct</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><h6 class="dropdown-header" data-toc-skip>Spatial transcriptomcis (ST) data</h6></li>
    <li><a class="dropdown-item" href="../articles/stPattern.html">Signaling patterns and velocities for multi-cellular ST data</a></li>
    <li><a class="dropdown-item" href="../articles/stCCC.html">Intercellular communication for single-cell resolution ST data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Single-cell RNA sequencing data</h6></li>
    <li><a class="dropdown-item" href="../articles/scState.html">Secreted protein signaling activity for various cell states</a></li>
    <li><a class="dropdown-item" href="../articles/scCCC.html">Cell-cell communication mediated by secreted proteins</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Bulk RNA sequencing data</h6></li>
    <li><a class="dropdown-item" href="../articles/bulkCohort.html">Clinical relevance of secreted proteins in a large patient cohort</a></li>
    <li><a class="dropdown-item" href="../articles/bulkChange.html">Secreted protein activity change between two phenotypes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/data2intelligence/SecAct/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Secreted protein signaling activity for distinct cell states from scRNA-Seq data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/data2intelligence/SecAct/blob/HEAD/vignettes/scState.Rmd" class="external-link"><code>vignettes/scState.Rmd</code></a></small>
      <div class="d-none name"><code>scState.Rmd</code></div>
    </div>

    
    
<p>This tutorial demonstrates how to infer secreted protein signaling
activity in various cell states. For this demonstration, we employ an
ovarian cancer scRNA-Seq
<a href="https://www.nature.com/articles/s43018-023-00599-8" target="_blank" class="external-link">study</a>.
Using the SecAct framework, we will estimate the signaling activity of
secreted proteins for different CD4+ T cell states.</p>
<div class="section level2">
<h2 id="load-scrna-seq-data">Load scRNA-Seq data<a class="anchor" aria-label="anchor" href="#load-scrna-seq-data"></a>
</h2>
<p>The scRNA-Seq data of CD4+ T cells is stored in a Seurat object.
Three cell states are annotated in this dataset, i.e., naive, central
memory, and helper 1-like.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/data2intelligence/SecAct" class="external-link">SecAct</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load scRNA-Seq data</span></span>
<span><span class="va">dataPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"SecAct"</span><span class="op">)</span>, <span class="st">"extdata/"</span><span class="op">)</span></span>
<span><span class="va">Seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dataPath</span>,<span class="st">"OV_scRNAseq_CD4.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># cell count</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Seurat_obj</span><span class="op">@</span><span class="va">meta.data</span><span class="op">[</span>,<span class="st">"Annotation"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## CD4_central_memory          CD4_naive       CD4_Th1_like </span></span>
<span><span class="co">##                402                 28                358 </span></span>
<span></span>
<span><span class="co"># show UMAP plot</span></span>
<span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">Seurat_obj</span>, reduction <span class="op">=</span> <span class="st">"umap"</span>, group.by <span class="op">=</span> <span class="st">"Annotation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/OV_CD4_UMAP.png" width="60%" style="border:none"></p>
</div>
<div class="section level2">
<h2 id="infer-secreted-protein-activity">Infer secreted protein activity<a class="anchor" aria-label="anchor" href="#infer-secreted-protein-activity"></a>
</h2>
<p>After loading scRNA-Seq data data, user can input
<code>Seurat_obj</code> into <code>SecAct.activity.inference</code> to
infer the signaling activities of secreted proteins for various cell
states. Also, you need to claim which column in the meta matrix of
Seurat object has cell state information. In this case, the column name
is “Annotation” and thus assign
<code>cellType_meta = "Annotation"</code>. User can find the SecAct
results in
<code>Seurat_obj @misc $SecAct_output $SecretedProteinActivity</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># infer activity; ~2 mins</span></span>
<span><span class="va">Seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SecAct.activity.inference.scRNAseq.html">SecAct.activity.inference.scRNAseq</a></span><span class="op">(</span><span class="va">Seurat_obj</span>, cellType_meta<span class="op">=</span><span class="st">"Annotation"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># SecretedProteinActivity$zscore stores activity</span></span>
<span><span class="va">act</span> <span class="op">&lt;-</span> <span class="va">Seurat_obj</span> <span class="op">@</span><span class="va">misc</span> <span class="op">$</span><span class="va">SecAct_output</span> <span class="op">$</span><span class="va">SecretedProteinActivity</span><span class="op">$</span><span class="va">zscore</span></span>
<span></span>
<span><span class="co"># show activity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">act</span><span class="op">)</span></span></code></pre></div>
<p>The inferred protein activity is a relative measure. A positive value
indicates high activity in the corresponding cell states, while a
negative value signifies low activity.</p>
</div>
<div class="section level2">
<h2 id="visualize-activity">Visualize activity<a class="anchor" aria-label="anchor" href="#visualize-activity"></a>
</h2>
<p>User can visualize any secreted proteins of interest using
<code>SecAct.heatmap.plot</code>. Here, we select the top active
secreted proteins (SPs) for each cell state.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select top secreted proteins</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">SPs.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">act</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span>
<span><span class="va">SPs.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">act</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span>
<span><span class="va">SPs.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">act</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span>
<span></span>
<span><span class="va">SPs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">SPs.1</span>, <span class="va">SPs.2</span>, <span class="va">SPs.3</span><span class="op">)</span></span>
<span><span class="co"># user can assign any secreted proteins to SPs</span></span>
<span></span>
<span><span class="co"># subset act matrix</span></span>
<span><span class="va">fg.mat</span> <span class="op">&lt;-</span> <span class="va">act</span><span class="op">[</span><span class="va">SPs</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># visualize in heatmap</span></span>
<span><span class="fu"><a href="../reference/SecAct.heatmap.plot.html">SecAct.heatmap.plot</a></span><span class="op">(</span><span class="va">fg.mat</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/OV_CD4_heatmap.png" width="38%" style="border:none"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Beibei Ru.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
