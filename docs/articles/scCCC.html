<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cell-cell communication mediated by secreted proteins from scRNA-Seq data • SecAct</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cell-cell communication mediated by secreted proteins from scRNA-Seq data">
<meta name="description" content="Cell-cell communication mediated by secreted proteins from scRNA-Seq data.
">
<meta property="og:description" content="Cell-cell communication mediated by secreted proteins from scRNA-Seq data.
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SecAct</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><h6 class="dropdown-header" data-toc-skip>Spatial transcriptomcis (ST) data</h6></li>
    <li><a class="dropdown-item" href="../articles/stPattern.html">Signaling patterns and velocities for multi-cellular ST data</a></li>
    <li><a class="dropdown-item" href="../articles/stCCC.html">Intercellular communication for single-cell resolution ST data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Single-cell RNA sequencing data</h6></li>
    <li><a class="dropdown-item" href="../articles/scCCC.html">Cell-cell communication mediated by secreted proteins</a></li>
    <li><a class="dropdown-item" href="../articles/scState.html">Secreted protein signaling activity for various cell states</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Bulk RNA sequencing data</h6></li>
    <li><a class="dropdown-item" href="../articles/bulkChange.html">Secreted protein activity change between two phenotypes</a></li>
    <li><a class="dropdown-item" href="../articles/bulkCohort.html">Clinical relevance of secreted proteins in a large patient cohort</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/data2intelligence/SecAct/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cell-cell communication mediated by secreted proteins from scRNA-Seq data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/data2intelligence/SecAct/blob/HEAD/vignettes/scCCC.Rmd" class="external-link"><code>vignettes/scCCC.Rmd</code></a></small>
      <div class="d-none name"><code>scCCC.Rmd</code></div>
    </div>

    
    
<p>This tutorial demonstrates how to infer secreted protein-mediated
cell-cell communication (CCC) from scRNA-seq data. This analysis
requires an scRNA-seq dataset with two distinct conditions. SecAct
employs two key criteria to identify condition-specific cell-cell
communication mediated by a particular secreted protein: (1) upregulated
gene expression of the secreted protein in one cell type (defined the
source cell type), and (2) increased signaling activity of the same
secreted protein in another cell type (defined the receiver cell type).
For this demonstration, we employ an ovarian cancer (OV) scRNA-Seq
<a href="https://www.nature.com/articles/s43018-023-00599-8" target="_blank" class="external-link">study</a>
containing samples from both primary and metastatic sites.</p>
<div class="section level2">
<h2 id="prepare-expression-matrix">Prepare expression matrix<a class="anchor" aria-label="anchor" href="#prepare-expression-matrix"></a>
</h2>
<p>The OV scRNA-Seq data is stored in a Seurat object. The information
of cell-type annotations and anatomical sites are stored in the columns
<code>MyCellType</code> and <code>Groups</code> of
<code>meta.data</code> from this Seurat object, respectively. Users can
easily access them using the following code.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/data2intelligence/SecAct" class="external-link">SecAct</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download data from https://hpc.nih.gov/~Jiang_Lab/SecAct_Package/OV_scRNAseq_Seurat.rds</span></span>
<span><span class="co"># load scRNA-Seq data</span></span>
<span><span class="va">Seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"OV_scRNAseq_Seurat.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># cell count</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Seurat_obj</span><span class="op">@</span><span class="va">meta.data</span><span class="op">[</span>,<span class="st">"Groups"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Metastatic    Primary </span></span>
<span><span class="co">##      18746      17589 </span></span>
<span></span>
<span><span class="co"># show UMAP plot</span></span>
<span><span class="va">my_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">'B'</span><span class="op">=</span><span class="st">'#C88888'</span>,<span class="st">'CD4T'</span><span class="op">=</span><span class="st">'#3288bd'</span>,<span class="st">'CD8T'</span><span class="op">=</span><span class="st">'#B95FBB'</span>,<span class="st">'DC'</span><span class="op">=</span><span class="st">'#63636d'</span>,</span>
<span>    <span class="st">'Endothelial'</span><span class="op">=</span><span class="st">'#D4D915'</span>,<span class="st">'Fibroblast'</span><span class="op">=</span><span class="st">'#66c2a5'</span>,<span class="st">'Macrophage'</span><span class="op">=</span><span class="st">'#ff9a36'</span>,</span>
<span>    <span class="st">'NK'</span><span class="op">=</span><span class="st">'#bb8761'</span>,<span class="st">'Tex'</span><span class="op">=</span><span class="st">'#fe666d'</span>,<span class="st">'Treg'</span><span class="op">=</span><span class="st">'#E6C122'</span>,<span class="st">'Tumor'</span><span class="op">=</span><span class="st">'#A4DFF2'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">Seurat_obj</span>, reduction <span class="op">=</span> <span class="st">"umap"</span>, cols <span class="op">=</span> <span class="va">my_cols</span>, group.by <span class="op">=</span> <span class="st">"MyCellType"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">Seurat_obj</span>, reduction <span class="op">=</span> <span class="st">"umap"</span>, group.by <span class="op">=</span> <span class="st">"Groups"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span></span></code></pre></div>
<p><img src="img/OV_UMAP.png" width="100%" style="border:none"></p>
</div>
<div class="section level2">
<h2 id="infer-cell-cell-communication">Infer cell-cell communication<a class="anchor" aria-label="anchor" href="#infer-cell-cell-communication"></a>
</h2>
<p><code>SecAct</code> performs three steps to infer condition-specific
cell-cell communication mediated by secreted proteins: (1) assessing
changes in secreted protein expression for each cell type (defined the
source cell type) between two conditions (e.g., Metastatic vs Primary),
(2) calculating changes in secreted protein signaling activity for each
cell type (defined the receiver cell type) between two conditions, and
(3) linking source and receiver cell types.</p>
<p>When running <code>SecAct.CCC.scRNAseq</code>, user need to assign
the <code>cellType_meta</code> and <code>condition_meta</code> with the
column names of cell-type annotation and condition information in
<code>Seurat_obj@meta.data</code>, respectively. Also, claim what case
and control conditions are by <code>conditionCase</code> and
<code>conditionControl</code>. User can find the SecAct results in
<code>Seurat_obj @misc $SecAct_output</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># infer CCC; ~2 mins</span></span>
<span><span class="va">Seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SecAct.CCC.scRNAseq.html">SecAct.CCC.scRNAseq</a></span><span class="op">(</span></span>
<span>  <span class="va">Seurat_obj</span>, </span>
<span>  cellType_meta<span class="op">=</span><span class="st">"MyCellType"</span>,</span>
<span>  condition_meta<span class="op">=</span><span class="st">"Groups"</span>, </span>
<span>  conditionCase<span class="op">=</span><span class="st">"Metastatic"</span>, </span>
<span>  conditionControl<span class="op">=</span><span class="st">"Primary"</span></span>
<span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># show output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Seurat_obj</span> <span class="op">@</span><span class="va">misc</span> <span class="op">$</span><span class="va">SecAct_output</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## [1] "SecretedProteinExpression"</span></span>
<span><span class="co">## [2] "SecretedProteinActivity"</span></span>
<span><span class="co">## [3] "SecretedProteinCCC"</span></span>
<span></span>
<span><span class="co"># cell-cell communication results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Seurat_obj</span> <span class="op">@</span><span class="va">misc</span> <span class="op">$</span><span class="va">SecAct_output</span> <span class="op">$</span><span class="va">SecretedProteinCCC</span><span class="op">)</span></span></code></pre></div>
<p>This table lists metastasis-specific cell–cell communication events
mediated by secreted proteins. Each row represents one interaction,
indicating that the corresponding secreted protein shows upregulated
expression in the sender cell type and increased signaling activity in
the receiver cell type under metastatic compared with primary
conditions.</p>
</div>
<div class="section level2">
<h2 id="visualize-cell-cell-communication">Visualize cell-cell communication<a class="anchor" aria-label="anchor" href="#visualize-cell-cell-communication"></a>
</h2>
<p>We provide two types of visualization plot for cell-cell
communication, i.e., heatmap and circle plot. The number in the heatmap
represents the count of secreted proteins from senders to receivers.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/SecAct.CCC.heatmap.html">SecAct.CCC.heatmap</a></span><span class="op">(</span><span class="va">Seurat_obj</span>, row.sorted<span class="op">=</span><span class="cn">TRUE</span>, column.sorted<span class="op">=</span><span class="cn">TRUE</span>, colors_cellType<span class="op">=</span><span class="va">my_cols</span><span class="op">)</span></span></code></pre></div>
<center>
<img src="img/OV_heatmap.png" width="50%" style="border:none">
</center>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/SecAct.CCC.circle.html">SecAct.CCC.circle</a></span><span class="op">(</span><span class="va">Seurat_obj</span>, colors_cellType<span class="op">=</span><span class="va">my_cols</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/SecAct.CCC.circle.html">SecAct.CCC.circle</a></span><span class="op">(</span><span class="va">Seurat_obj</span>, receiver<span class="op">=</span><span class="st">"Tumor"</span>, colors_cellType<span class="op">=</span><span class="va">my_cols</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/OV_circlize.png" width="45%" style="border:none"><img src="img/OV_circlize2.png" width="45%" style="border:none"></p>
</div>
<div class="section level2">
<h2 id="visualize-secreted-signaling-flow">Visualize secreted signaling flow<a class="anchor" aria-label="anchor" href="#visualize-secreted-signaling-flow"></a>
</h2>
<p>User can select the cell-cell communication of interest from
<code>Seurat_obj @misc $SecAct_output $SecretedProteinCCC</code> to
visualize them using <code>SecAct.CCC.sankey</code>. You need to assign
values to <code>sender</code>, <code>secretedProtein</code>, and
<code>receiver</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fibroblast"</span>,<span class="st">"Macrophage"</span>,<span class="st">"Endothelial"</span>,<span class="st">"CD8T"</span>,<span class="st">"Tex"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">secretedProtein</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"BGN"</span>,<span class="st">"BMP1"</span>,<span class="st">"COL15A1"</span>,<span class="st">"COL18A1"</span>,<span class="st">"COL1A1"</span>,</span>
<span>  <span class="st">"COL1A2"</span>,<span class="st">"CST3"</span>,<span class="st">"FAP"</span>,<span class="st">"FBN1"</span>,<span class="st">"FN1"</span>,</span>
<span>  <span class="st">"FSTL1"</span>,<span class="st">"HSPG2"</span>,<span class="st">"HTRA1"</span>,<span class="st">"ISG15"</span>,<span class="st">"MXRA5"</span>,</span>
<span>  <span class="st">"POSTN"</span>,<span class="st">"SERPING1"</span>,<span class="st">"SPARC"</span>,<span class="st">"TGFB1"</span>,<span class="st">"TGFBI"</span>,</span>
<span>  <span class="st">"THBS2"</span>,<span class="st">"TIMP1"</span>,<span class="st">"VCAN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">receiver</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumor"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/SecAct.CCC.sankey.html">SecAct.CCC.sankey</a></span><span class="op">(</span></span>
<span>  <span class="va">Seurat_obj</span>, </span>
<span>  colors_cellType <span class="op">=</span> <span class="va">my_cols</span>, </span>
<span>  sender <span class="op">=</span> <span class="va">sender</span>, </span>
<span>  secretedProtein <span class="op">=</span> <span class="va">secretedProtein</span>, </span>
<span>  receiver <span class="op">=</span> <span class="va">receiver</span></span>
<span><span class="op">)</span></span></code></pre></div>
<center>
<img src="img/OV_sankey_Tumor.png" width="70%" style="border:none">
</center>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Beibei Ru.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
