<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Infer secreted protein activity in spatial transcriptomics data.
">
<title>Infer secreted protein activity in spatial transcriptomics data â€¢ SecAct</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Infer secreted protein activity in spatial transcriptomics data">
<meta property="og:description" content="Infer secreted protein activity in spatial transcriptomics data.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SecAct</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/data2intelligence/SecAct/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Infer secreted protein activity in spatial transcriptomics data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/data2intelligence/SecAct/blob/HEAD/vignettes/spatial.Rmd" class="external-link"><code>vignettes/spatial.Rmd</code></a></small>
      <div class="d-none name"><code>spatial.Rmd</code></div>
    </div>

    
    
<p>This tutorial demonstrates how to run SecAct to infer secreted
protein activity and signaling velocity using a spatial transcriptomics
(ST) dataset from endometrial cancer (<a href="https://www.nature.com/articles/s41586-023-06367-z" target="_blank" class="external-link">Paper</a>). Before running the tutorial, make sure that
you have installed SecAct package as well as SpaCET package. The latter
will be employed to create an SpaCET object to store the ST data.</p>
<div class="section level2">
<h2 id="read-st-data-to-an-spacet-object">Read ST data to an SpaCET object<a class="anchor" aria-label="anchor" href="#read-st-data-to-an-spacet-object"></a>
</h2>
<p>First, download the ST data from <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE225690" target="_blank" class="external-link">GSE225690</a>. This dataset includes two endometrial
cancer patients treated with anti-Netrin-1 (NTN1) compound. Netrin-1 is
a secreted glycoprotein that plays critical roles in angiogenesis and
cell survival, and blocking NTN1 inhibits tumor growth. In the data
folder, 01_039_C1d1 and 01_039_C3d1 represent pre- and on-treatment
tumor samples for Patient 01_039, respectively. To read ST data into R,
user can create an SpaCET object by using
<code>create.SpaCET.object.10X</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/data2intelligence/SpaCET" class="external-link">SpaCET</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set the path to the download folder.</span></span>
<span><span class="va">dataPath</span> <span class="op">&lt;-</span> <span class="st">"/Users/rub2/Downloads/GSE225690_RAW/"</span></span>
<span></span>
<span><span class="co"># load ST data to create an SpaCET object.</span></span>
<span><span class="co"># read on-treatment sample</span></span>
<span><span class="va">visiumPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dataPath</span>,<span class="st">"01_039_C3d1/outs/"</span><span class="op">)</span></span>
<span><span class="va">SpaCET_obj_on</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SpaCET/man/create.SpaCET.object.10X.html" class="external-link">create.SpaCET.object.10X</a></span><span class="op">(</span>visiumPath <span class="op">=</span> <span class="va">visiumPath</span><span class="op">)</span></span>
<span><span class="va">SpaCET_obj_on</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SpaCET/man/SpaCET.quality.control.html" class="external-link">SpaCET.quality.control</a></span><span class="op">(</span><span class="va">SpaCET_obj_on</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read pre-treatment sample</span></span>
<span><span class="va">visiumPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dataPath</span>,<span class="st">"01_039_C1d1/outs/"</span><span class="op">)</span></span>
<span><span class="va">SpaCET_obj_pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SpaCET/man/create.SpaCET.object.10X.html" class="external-link">create.SpaCET.object.10X</a></span><span class="op">(</span>visiumPath <span class="op">=</span> <span class="va">visiumPath</span><span class="op">)</span></span>
<span><span class="va">SpaCET_obj_pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SpaCET/man/SpaCET.quality.control.html" class="external-link">SpaCET.quality.control</a></span><span class="op">(</span><span class="va">SpaCET_obj_pre</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="infer-secreted-protein-activity">Infer secreted protein activity<a class="anchor" aria-label="anchor" href="#infer-secreted-protein-activity"></a>
</h2>
<p>After loading ST data, user can run <code>SecAct.inference</code> to
infer the activities of over 1000 secreted proteins across each spot. Of
note, we recommend user set the parameter <code>Ycontrol</code> to
include a control (or background) for the current ST sample. For
example, to analyze the on-treatment sample, the pre-treatment sample
can be set as a control. <code>SecAct</code> will normalize the
expression values of each gene in the on-treatment sample with the
all-spot mean from the pre-treatment sample.</p>
<p>When analyzing the pre-treatment sample, a control sample is
unavailable. You can just set the <code>Ycontrol</code> as NULL.
<code>SecAct</code> will normalize the expression values of each gene in
the pre-treatment sample to zero mean across all spots. In other words,
<code>SecAct</code> regards the same ST sample as a control sample.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/data2intelligence/SecAct" class="external-link">SecAct</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate secreted protein activity for the on-treatment sample</span></span>
<span><span class="va">SpaCET_obj_on</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SecAct.inference.html">SecAct.inference</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">SpaCET_obj_on</span>, Ycontrol <span class="op">=</span> <span class="va">SpaCET_obj_pre</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate secreted protein activity for the pre-treatment sample</span></span>
<span><span class="va">SpaCET_obj_pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SecAct.inference.html">SecAct.inference</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">SpaCET_obj_pre</span>, Ycontrol <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show the activity value</span></span>
<span><span class="va">SpaCET_obj_on</span><span class="op">@</span><span class="va">results</span><span class="op">$</span><span class="va">SecAct_res</span><span class="op">$</span><span class="va">zscore</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">SpaCET_obj_pre</span><span class="op">@</span><span class="va">results</span><span class="op">$</span><span class="va">SecAct_res</span><span class="op">$</span><span class="va">zscore</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-the-cell-type-proportion">Visualize the cell type proportion<a class="anchor" aria-label="anchor" href="#visualize-the-cell-type-proportion"></a>
</h2>
<p>We provide <code>SpaCET.visualize.spatialFeature</code> to present
the spatial distribution of cell types.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show the spatial distribution of malignant cells and macrophages.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SpaCET/man/SpaCET.visualize.spatialFeature.html" class="external-link">SpaCET.visualize.spatialFeature</a></span><span class="op">(</span></span>
<span>  <span class="va">SpaCET_obj</span>, </span>
<span>  spatialType <span class="op">=</span> <span class="st">"CellFraction"</span>, </span>
<span>  spatialFeatures<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Malignant"</span>,<span class="st">"Macrophage"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="img/visualizeDeconvolution.png" width="100%" style="border:none"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show the spatial distribution of all cell types.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SpaCET/man/SpaCET.visualize.spatialFeature.html" class="external-link">SpaCET.visualize.spatialFeature</a></span><span class="op">(</span></span>
<span>  <span class="va">SpaCET_obj</span>, </span>
<span>  spatialType <span class="op">=</span> <span class="st">"CellFraction"</span>, </span>
<span>  spatialFeatures<span class="op">=</span><span class="st">"All"</span>, </span>
<span>  sameScaleForFraction <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pointSize <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>  nrow<span class="op">=</span><span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="img/visualizeDeconvolution2.png" width="100%" style="border:none"></p>
<p>Since some cell types have relatively low abundance, user can get a
better vision by setting <code>sameScaleForFraction = FALSE</code>. In
addition, you can open up an interactive visualization panel by setting
<code>interactive=TRUE</code> to browse the deconvolution results.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SpaCET/man/SpaCET.visualize.spatialFeature.html" class="external-link">SpaCET.visualize.spatialFeature</a></span><span class="op">(</span><span class="va">SpaCET_obj</span>,interactive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/visualizeDeconvolution3.png" width="94%" style="border:none"></p>
</div>
<div class="section level2">
<h2 id="estimate-cell-cell-interactions">Estimate cell-cell interactions<a class="anchor" aria-label="anchor" href="#estimate-cell-cell-interactions"></a>
</h2>
<p>After decomposing cell fractions, SpaCET can infer intercellular
interactions based on cell colocalization and ligand-receptor
coexpression. Linear correlations of cell fraction between cell types
are computed across all ST spots to evaluate cell-type colocalization.
High positive correlations indicate that cell-type pairs tend to
colocalize together. To infer physical interactions, SpaCET tests the
co-expression of ligand and receptor genes within the same ST spot for
the co-localized cell-type pairs.</p>
<div class="section level3">
<h3 id="find-co-localized-cell-type-pairs">Find co-localized cell-type pairs<a class="anchor" aria-label="anchor" href="#find-co-localized-cell-type-pairs"></a>
</h3>
<p>SpaCET provides <code>SpaCET.CCI.colocalization</code> and
<code>SpaCET.visualize.colocalization</code> to compute and visualize
the co-localized cell-type pairs.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the cell-cell colocalization.</span></span>
<span><span class="va">SpaCET_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SpaCET/man/SpaCET.CCI.colocalization.html" class="external-link">SpaCET.CCI.colocalization</a></span><span class="op">(</span><span class="va">SpaCET_obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize the cell-cell colocalization.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SpaCET/man/SpaCET.visualize.colocalization.html" class="external-link">SpaCET.visualize.colocalization</a></span><span class="op">(</span><span class="va">SpaCET_obj</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/CCC.png" width="100%" style="border:none"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Beibei Ru, Peng Jiang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
