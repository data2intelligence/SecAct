#!/bin/bash

echo "Checking for GSL..."

GSL_CFLAGS=$(gsl-config --cflags)
GSL_LIBS=$(gsl-config --libs)

if [ -z "$GSL_CFLAGS" ] || [ -z "$GSL_LIBS" ]; then
    echo "ERROR: GSL not found."
    echo "Please install GSL first:"
    echo "  macOS: brew install gsl"
    echo "  Ubuntu/Debian: sudo apt-get install libgsl-dev"
    echo "  RedHat/CentOS: sudo yum install gsl-devel"
    echo "  Fedora/RHEL: sudo dnf install gsl-devel"
    exit 1
fi

echo "GSL found!"

#make the Makevars file
if [ ! -e "./src/Makevars" ]; then
    touch ./src/Makevars
fi

#provides the necessary compiler flags.
echo "PKG_CFLAGS = \$(shell gsl-config --cflags)" > ./src/Makevars

#links the GSL library.
echo "PKG_LIBS = \$(shell gsl-config --libs)" >> ./src/Makevars

echo "GSL_CFLAGS=${GSL_CFLAGS}" >> src/Makevars
echo "GSL_LIBS=${GSL_LIBS}" >> src/Makevars
